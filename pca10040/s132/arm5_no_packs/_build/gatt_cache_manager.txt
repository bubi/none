; generated by Component: ARM Compiler 5.06 update 3 (build 300) Tool: ArmCC [4d35f0]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\_build\gatt_cache_manager.o --asm_dir=.\_build\ --list_dir=.\_build\ --depend=.\_build\gatt_cache_manager.d --cpu=Cortex-M4.fp --apcs=interwork -O0 --diag_suppress=9931 -I..\..\..\config\bluetoothds_template_pca10040_s132 -I..\..\..\config -I..\..\..\..\..\..\components -I..\..\..\..\..\..\components\ble\ble_advertising -I..\..\..\..\..\..\components\ble\ble_dtm -I..\..\..\..\..\..\components\ble\ble_racp -I..\..\..\..\..\..\components\ble\ble_services\ble_ancs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_ans_c -I..\..\..\..\..\..\components\ble\ble_services\ble_bas -I..\..\..\..\..\..\components\ble\ble_services\ble_bas_c -I..\..\..\..\..\..\components\ble\ble_services\ble_cscs -I..\..\..\..\..\..\components\ble\ble_services\ble_cts_c -I..\..\..\..\..\..\components\ble\ble_services\ble_dfu -I..\..\..\..\..\..\components\ble\ble_services\ble_dis -I..\..\..\..\..\..\components\ble\ble_services\ble_gls -I..\..\..\..\..\..\components\ble\ble_services\ble_hids -I..\..\..\..\..\..\components\ble\ble_services\ble_hrs -I..\..\..\..\..\..\components\ble\ble_services\ble_hrs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_hts -I..\..\..\..\..\..\components\ble\ble_services\ble_ias -I..\..\..\..\..\..\components\ble\ble_services\ble_ias_c -I..\..\..\..\..\..\components\ble\ble_services\ble_lbs -I..\..\..\..\..\..\components\ble\ble_services\ble_lbs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_lls -I..\..\..\..\..\..\components\ble\ble_services\ble_nus -I..\..\..\..\..\..\components\ble\ble_services\ble_nus_c -I..\..\..\..\..\..\components\ble\ble_services\ble_rscs -I..\..\..\..\..\..\components\ble\ble_services\ble_rscs_c -I..\..\..\..\..\..\components\ble\ble_services\ble_tps -I..\..\..\..\..\..\components\ble\common -I..\..\..\..\..\..\components\ble\nrf_ble_qwr -I..\..\..\..\..\..\components\ble\peer_manager -I..\..\..\..\..\..\components\drivers_nrf\adc -I..\..\..\..\..\..\components\drivers_nrf\clock -I..\..\..\..\..\..\components\drivers_nrf\common -I..\..\..\..\..\..\components\drivers_nrf\comp -I..\..\..\..\..\..\components\drivers_nrf\delay -I..\..\..\..\..\..\components\drivers_nrf\gpiote -I..\..\..\..\..\..\components\drivers_nrf\hal -I..\..\..\..\..\..\components\drivers_nrf\i2s -I..\..\..\..\..\..\components\drivers_nrf\lpcomp -I..\..\..\..\..\..\components\drivers_nrf\pdm -I..\..\..\..\..\..\components\drivers_nrf\ppi -I..\..\..\..\..\..\components\drivers_nrf\pwm -I..\..\..\..\..\..\components\drivers_nrf\qdec -I..\..\..\..\..\..\components\drivers_nrf\rng -I..\..\..\..\..\..\components\drivers_nrf\rtc -I..\..\..\..\..\..\components\drivers_nrf\saadc -I..\..\..\..\..\..\components\drivers_nrf\spi_master -I..\..\..\..\..\..\components\drivers_nrf\spi_slave -I..\..\..\..\..\..\components\drivers_nrf\swi -I..\..\..\..\..\..\components\drivers_nrf\timer -I..\..\..\..\..\..\components\drivers_nrf\twi_master -I..\..\..\..\..\..\components\drivers_nrf\twis_slave -I..\..\..\..\..\..\components\drivers_nrf\uart -I..\..\..\..\..\..\components\drivers_nrf\wdt -I..\..\..\..\..\..\components\libraries\button -I..\..\..\..\..\..\components\libraries\crc16 -I..\..\..\..\..\..\components\libraries\crc32 -I..\..\..\..\..\..\components\libraries\csense -I..\..\..\..\..\..\components\libraries\csense_drv -I..\..\..\..\..\..\components\libraries\experimental_section_vars -I..\..\..\..\..\..\components\libraries\fds -I..\..\..\..\..\..\components\libraries\fifo -I..\..\..\..\..\..\components\libraries\fstorage -I..\..\..\..\..\..\components\libraries\hardfault -I..\..\..\..\..\..\components\libraries\hci -I..\..\..\..\..\..\components\libraries\led_softblink -I..\..\..\..\..\..\components\libraries\log -I..\..\..\..\..\..\components\libraries\log\src -I..\..\..\..\..\..\components\libraries\low_power_pwm -I..\..\..\..\..\..\components\libraries\mailbox -I..\..\..\..\..\..\components\libraries\mem_manager -I..\..\..\..\..\..\components\libraries\pwm -I..\..\..\..\..\..\components\libraries\scheduler -I..\..\..\..\..\..\components\libraries\slip -I..\..\..\..\..\..\components\libraries\timer -I..\..\..\..\..\..\components\libraries\twi -I..\..\..\..\..\..\components\libraries\uart -I..\..\..\..\..\..\components\libraries\util -I..\..\..\..\..\..\components\softdevice\common\softdevice_handler -I..\..\..\..\..\..\components\softdevice\s132\headers -I..\..\..\..\..\..\components\softdevice\s132\headers\nrf52 -I..\..\..\..\..\..\components\toolchain -I..\..\..\..\..\bsp -I..\..\..\..\..\..\external\segger_rtt -I..\config -I..\..\..\..\none -I..\..\..\..\..\..\components\drivers_ext\LS013B7DH06 -I..\..\..\..\..\..\external\ugfx -I..\..\..\..\..\..\external\ugfx\drivers\gdisp\framebuffer -I..\..\..\..\..\..\external\ugfx\src\gdisp -I..\..\..\..\..\..\external\ugfx\drivers\gdisp\ -IC:\Users\Michael\Documents\none\nRF5_SDK_12.1.0_0d23e2a\examples\ble_peripheral\none\pca10040\s132\arm5_no_packs\RTE -IC:\Keil_v5\ARM\PACK\ARM\CMSIS\4.5.0\CMSIS\Include -IC:\Keil_v5\ARM\PACK\NordicSemiconductor\nRF_DeviceFamilyPack\8.9.0\Device\Include -D__MICROLIB -D__UVISION_VERSION=521 -D_RTE_ -DNRF52 -DBLE_STACK_SUPPORT_REQD -D__HEAP_SIZE=0 -DS132 -DNRF_SD_BLE_API_VERSION=3 -DBOARD_PCA10040 -DNRF52_PAN_12 -DNRF52_PAN_15 -DNRF52_PAN_20 -DNRF52_PAN_30 -DNRF52_PAN_31 -DNRF52_PAN_36 -DNRF52_PAN_51 -DNRF52_PAN_53 -DNRF52_PAN_54 -DNRF52_PAN_55 -DNRF52_PAN_58 -DNRF52_PAN_62 -DNRF52_PAN_63 -DNRF52_PAN_64 -DCONFIG_GPIO_AS_PINRESET -DSOFTDEVICE_PRESENT -DNRF52832 -DNRF52 -DSWI_DISABLE0 --omf_browse=.\_build\gatt_cache_manager.crf ..\..\..\..\..\..\components\ble\peer_manager\gatt_cache_manager.c]
                          THUMB

                          AREA ||i.apply_pending_flags_check||, CODE, READONLY, ALIGN=2

                  apply_pending_flags_check PROC
;;;381     */
;;;382    static void apply_pending_flags_check(void)
000000  b530              PUSH     {r4,r5,lr}
;;;383    {
000002  b08b              SUB      sp,sp,#0x2c
;;;384        sdk_mapped_flags_t apply_pending_flags;
;;;385    
;;;386        apply_pending_flags = ble_conn_state_user_flag_collection(m_flag_local_db_apply_pending);
000004  4813              LDR      r0,|L1.84|
000006  7800              LDRB     r0,[r0,#0]  ; m_flag_local_db_apply_pending
000008  f7fffffe          BL       ble_conn_state_user_flag_collection
00000c  4605              MOV      r5,r0
;;;387        if (sdk_mapped_flags_any_set(apply_pending_flags))
00000e  4628              MOV      r0,r5
000010  f7fffffe          BL       sdk_mapped_flags_any_set
000014  b1d8              CBZ      r0,|L1.78|
;;;388        {
;;;389            sdk_mapped_flags_key_list_t conn_handle_list;
;;;390            conn_handle_list = ble_conn_state_conn_handles();
000016  a801              ADD      r0,sp,#4
000018  f7fffffe          BL       ble_conn_state_conn_handles
00001c  2214              MOVS     r2,#0x14
00001e  a901              ADD      r1,sp,#4
000020  a806              ADD      r0,sp,#0x18
000022  f7fffffe          BL       __aeabi_memcpy4
;;;391    
;;;392            for (uint32_t i = 0; i < conn_handle_list.len; i++)
000026  2400              MOVS     r4,#0
000028  e00d              B        |L1.70|
                  |L1.42|
;;;393            {
;;;394                if (ble_conn_state_user_flag_get(conn_handle_list.flag_keys[i], m_flag_local_db_apply_pending))
00002a  a907              ADD      r1,sp,#0x1c
00002c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000030  4908              LDR      r1,|L1.84|
000032  7809              LDRB     r1,[r1,#0]  ; m_flag_local_db_apply_pending
000034  f7fffffe          BL       ble_conn_state_user_flag_get
000038  b120              CBZ      r0,|L1.68|
;;;395                {
;;;396                    local_db_apply_in_evt(conn_handle_list.flag_keys[i]);
00003a  a907              ADD      r1,sp,#0x1c
00003c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000040  f7fffffe          BL       local_db_apply_in_evt
                  |L1.68|
000044  1c64              ADDS     r4,r4,#1              ;392
                  |L1.70|
000046  9806              LDR      r0,[sp,#0x18]         ;392
000048  42a0              CMP      r0,r4                 ;392
00004a  d8ee              BHI      |L1.42|
;;;397                }
;;;398            }
;;;399        }
00004c  bf00              NOP      
                  |L1.78|
;;;400    }
00004e  b00b              ADD      sp,sp,#0x2c
000050  bd30              POP      {r4,r5,pc}
;;;401    
                          ENDP

000052  0000              DCW      0x0000
                  |L1.84|
                          DCD      m_flag_local_db_apply_pending

                          AREA ||i.cccd_written||, CODE, READONLY, ALIGN=1

                  cccd_written PROC
;;;74      */
;;;75     static bool cccd_written(ble_gatts_evt_write_t * p_write_evt)
000000  4601              MOV      r1,r0
;;;76     {
;;;77         return (    (p_write_evt->op        == BLE_GATTS_OP_WRITE_REQ)
000002  7988              LDRB     r0,[r1,#6]
000004  2801              CMP      r0,#1
000006  d109              BNE      |L2.28|
;;;78                  && (p_write_evt->uuid.type == BLE_UUID_TYPE_BLE)
000008  7908              LDRB     r0,[r1,#4]
00000a  2801              CMP      r0,#1
00000c  d106              BNE      |L2.28|
;;;79                  && (p_write_evt->uuid.uuid == BLE_UUID_DESCRIPTOR_CLIENT_CHAR_CONFIG)
00000e  8848              LDRH     r0,[r1,#2]
000010  f6421202          MOV      r2,#0x2902
000014  4290              CMP      r0,r2
000016  d101              BNE      |L2.28|
000018  2001              MOVS     r0,#1
                  |L2.26|
;;;80                );
;;;81     }
00001a  4770              BX       lr
                  |L2.28|
00001c  2000              MOVS     r0,#0                 ;79
00001e  e7fc              B        |L2.26|
;;;82     
                          ENDP


                          AREA ||i.evt_send||, CODE, READONLY, ALIGN=2

                  evt_send PROC
;;;58     
;;;59     static void evt_send(gcm_evt_t const * p_gcm_evt)
000000  b570              PUSH     {r4-r6,lr}
;;;60     {
000002  4605              MOV      r5,r0
;;;61         for (uint32_t i = 0; i < GCM_EVENT_HANDLERS_CNT; i++)
000004  2400              MOVS     r4,#0
000006  e005              B        |L3.20|
                  |L3.8|
;;;62         {
;;;63             m_evt_handlers[i](p_gcm_evt);
000008  4804              LDR      r0,|L3.28|
00000a  f8501024          LDR      r1,[r0,r4,LSL #2]
00000e  4628              MOV      r0,r5
000010  4788              BLX      r1
000012  1c64              ADDS     r4,r4,#1              ;61
                  |L3.20|
000014  2c00              CMP      r4,#0                 ;61
000016  d0f7              BEQ      |L3.8|
;;;64         }
;;;65     }
000018  bd70              POP      {r4-r6,pc}
;;;66     
                          ENDP

00001a  0000              DCW      0x0000
                  |L3.28|
                          DCD      m_evt_handlers

                          AREA ||i.gcm_ble_evt_handler||, CODE, READONLY, ALIGN=2

                  gcm_ble_evt_handler PROC
;;;455     */
;;;456    void gcm_ble_evt_handler(ble_evt_t * p_ble_evt)
000000  b53e              PUSH     {r1-r5,lr}
;;;457    {
000002  4604              MOV      r4,r0
;;;458        gcm_evt_t event;
;;;459    
;;;460        switch (p_ble_evt->header.evt_id)
000004  8820              LDRH     r0,[r4,#0]
000006  2850              CMP      r0,#0x50
000008  d021              BEQ      |L4.78|
00000a  2852              CMP      r0,#0x52
00000c  d002              BEQ      |L4.20|
00000e  2854              CMP      r0,#0x54
000010  d125              BNE      |L4.94|
000012  e003              B        |L4.28|
                  |L4.20|
;;;461        {
;;;462            case BLE_GATTS_EVT_SYS_ATTR_MISSING:
;;;463                local_db_apply_in_evt(p_ble_evt->evt.gatts_evt.conn_handle);
000014  88a0              LDRH     r0,[r4,#4]
000016  f7fffffe          BL       local_db_apply_in_evt
;;;464                break;
00001a  e020              B        |L4.94|
                  |L4.28|
;;;465    
;;;466            case BLE_GATTS_EVT_SC_CONFIRM:
;;;467                event.evt_id = GCM_EVT_SERVICE_CHANGED_IND_CONFIRMED;
00001c  2006              MOVS     r0,#6
00001e  f88d0000          STRB     r0,[sp,#0]
;;;468                event.peer_id = im_peer_id_get_by_conn_handle(p_ble_evt->evt.gatts_evt.conn_handle);
000022  88a0              LDRH     r0,[r4,#4]
000024  f7fffffe          BL       im_peer_id_get_by_conn_handle
000028  f8ad0002          STRH     r0,[sp,#2]
;;;469                event.params.service_changed_ind_sent.conn_handle = p_ble_evt->evt.gatts_evt.conn_handle;
00002c  88a0              LDRH     r0,[r4,#4]
00002e  f8ad0004          STRH     r0,[sp,#4]
;;;470    
;;;471                gscm_db_change_notification_done(event.peer_id);
000032  f8bd0002          LDRH     r0,[sp,#2]
000036  f7fffffe          BL       gscm_db_change_notification_done
;;;472                ble_conn_state_user_flag_set(p_ble_evt->evt.gatts_evt.conn_handle, m_flag_service_changed_pending, false);
00003a  88a0              LDRH     r0,[r4,#4]
00003c  2200              MOVS     r2,#0
00003e  490c              LDR      r1,|L4.112|
000040  7809              LDRB     r1,[r1,#0]  ; m_flag_service_changed_pending
000042  f7fffffe          BL       ble_conn_state_user_flag_set
;;;473    
;;;474                evt_send(&event);
000046  4668              MOV      r0,sp
000048  f7fffffe          BL       evt_send
;;;475                break;
00004c  e007              B        |L4.94|
                  |L4.78|
;;;476    
;;;477            case BLE_GATTS_EVT_WRITE:
;;;478                if (cccd_written(&p_ble_evt->evt.gatts_evt.params.write))
00004e  1da0              ADDS     r0,r4,#6
000050  f7fffffe          BL       cccd_written
000054  b110              CBZ      r0,|L4.92|
;;;479                {
;;;480                    local_db_update_in_evt(p_ble_evt->evt.gatts_evt.conn_handle);
000056  88a0              LDRH     r0,[r4,#4]
000058  f7fffffe          BL       local_db_update_in_evt
                  |L4.92|
;;;481                }
;;;482                break;
00005c  bf00              NOP      
                  |L4.94|
00005e  bf00              NOP                            ;464
;;;483        }
;;;484    
;;;485        apply_pending_flags_check();
000060  f7fffffe          BL       apply_pending_flags_check
;;;486        update_pending_flags_check();
000064  f7fffffe          BL       update_pending_flags_check
;;;487        service_changed_pending_flags_check();
000068  f7fffffe          BL       service_changed_pending_flags_check
;;;488    }
00006c  bd3e              POP      {r1-r5,pc}
;;;489    
                          ENDP

00006e  0000              DCW      0x0000
                  |L4.112|
                          DCD      m_flag_service_changed_pending

                          AREA ||i.gcm_gscm_evt_handler||, CODE, READONLY, ALIGN=2

                  gcm_gscm_evt_handler PROC
;;;275     */
;;;276    void gcm_gscm_evt_handler(gscm_evt_t const * p_event)
000000  b53e              PUSH     {r1-r5,lr}
;;;277    {
000002  4604              MOV      r4,r0
;;;278        gcm_evt_t event;
;;;279        event.peer_id = p_event->peer_id;
000004  8860              LDRH     r0,[r4,#2]
000006  f8ad0002          STRH     r0,[sp,#2]
;;;280    
;;;281        switch (p_event->evt_id)
00000a  7820              LDRB     r0,[r4,#0]
00000c  b120              CBZ      r0,|L5.24|
00000e  2801              CMP      r0,#1
000010  d00f              BEQ      |L5.50|
000012  2802              CMP      r0,#2
000014  d12b              BNE      |L5.110|
000016  e016              B        |L5.70|
                  |L5.24|
;;;282        {
;;;283            case GSCM_EVT_LOCAL_DB_CACHE_STORED:
;;;284                event.evt_id = GCM_EVT_LOCAL_DB_CACHE_STORED;
000018  2000              MOVS     r0,#0
00001a  f88d0000          STRB     r0,[sp,#0]
;;;285    
;;;286                evt_send(&event);
00001e  4668              MOV      r0,sp
000020  f7fffffe          BL       evt_send
;;;287                local_db_apply_in_evt(im_conn_handle_get(p_event->peer_id));
000024  8860              LDRH     r0,[r4,#2]
000026  f7fffffe          BL       im_conn_handle_get
00002a  4605              MOV      r5,r0
00002c  f7fffffe          BL       local_db_apply_in_evt
;;;288                break;
000030  e01d              B        |L5.110|
                  |L5.50|
;;;289    
;;;290            case GSCM_EVT_LOCAL_DB_CACHE_UPDATED:
;;;291                event.evt_id = GCM_EVT_LOCAL_DB_CACHE_UPDATED;
000032  2001              MOVS     r0,#1
000034  f88d0000          STRB     r0,[sp,#0]
;;;292                event.params.local_db_cache_updated.conn_handle = p_event->params.local_db_cache_updated.conn_handle;
000038  88a0              LDRH     r0,[r4,#4]
00003a  f8ad0004          STRH     r0,[sp,#4]
;;;293    
;;;294                evt_send(&event);
00003e  4668              MOV      r0,sp
000040  f7fffffe          BL       evt_send
;;;295                break;
000044  e013              B        |L5.110|
                  |L5.70|
;;;296    
;;;297            case GSCM_EVT_SC_STATE_STORED:
;;;298                if (p_event->params.sc_state_stored.state)
000046  7920              LDRB     r0,[r4,#4]
000048  b180              CBZ      r0,|L5.108|
;;;299                {
;;;300                    uint16_t conn_handle = im_conn_handle_get(p_event->peer_id);
00004a  8860              LDRH     r0,[r4,#2]
00004c  f7fffffe          BL       im_conn_handle_get
000050  4605              MOV      r5,r0
;;;301                    if (conn_handle != BLE_CONN_HANDLE_INVALID)
000052  f64f70ff          MOV      r0,#0xffff
000056  4285              CMP      r5,r0
000058  d007              BEQ      |L5.106|
;;;302                    {
;;;303                        ble_conn_state_user_flag_set(conn_handle, m_flag_service_changed_pending, true);
00005a  2201              MOVS     r2,#1
00005c  4805              LDR      r0,|L5.116|
00005e  7801              LDRB     r1,[r0,#0]  ; m_flag_service_changed_pending
000060  4628              MOV      r0,r5
000062  f7fffffe          BL       ble_conn_state_user_flag_set
;;;304                        service_changed_pending_flags_check();
000066  f7fffffe          BL       service_changed_pending_flags_check
                  |L5.106|
;;;305                    }
;;;306                }
00006a  bf00              NOP      
                  |L5.108|
;;;307                break;
00006c  bf00              NOP      
                  |L5.110|
00006e  bf00              NOP                            ;288
;;;308        }
;;;309    }
000070  bd3e              POP      {r1-r5,pc}
;;;310    
                          ENDP

000072  0000              DCW      0x0000
                  |L5.116|
                          DCD      m_flag_service_changed_pending

                          AREA ||i.gcm_im_evt_handler||, CODE, READONLY, ALIGN=2

                  gcm_im_evt_handler PROC
;;;316     */
;;;317    void gcm_im_evt_handler(im_evt_t const * p_event)
000000  b510              PUSH     {r4,lr}
;;;318    {
000002  4604              MOV      r4,r0
;;;319        switch (p_event->evt_id)
000004  7820              LDRB     r0,[r4,#0]
000006  2801              CMP      r0,#1
000008  d10d              BNE      |L6.38|
;;;320        {
;;;321            case IM_EVT_BONDED_PEER_CONNECTED:
;;;322                local_db_apply_in_evt(p_event->conn_handle);
00000a  8860              LDRH     r0,[r4,#2]
00000c  f7fffffe          BL       local_db_apply_in_evt
;;;323                if (gscm_service_changed_ind_needed(p_event->conn_handle))
000010  8860              LDRH     r0,[r4,#2]
000012  f7fffffe          BL       gscm_service_changed_ind_needed
000016  b128              CBZ      r0,|L6.36|
;;;324                {
;;;325                    ble_conn_state_user_flag_set(p_event->conn_handle, m_flag_service_changed_pending, true);
000018  8860              LDRH     r0,[r4,#2]
00001a  2201              MOVS     r2,#1
00001c  4903              LDR      r1,|L6.44|
00001e  7809              LDRB     r1,[r1,#0]  ; m_flag_service_changed_pending
000020  f7fffffe          BL       ble_conn_state_user_flag_set
                  |L6.36|
;;;326                }
;;;327                break;
000024  e000              B        |L6.40|
                  |L6.38|
;;;328            default:
;;;329                break;
000026  bf00              NOP      
                  |L6.40|
000028  bf00              NOP                            ;327
;;;330        }
;;;331    }
00002a  bd10              POP      {r4,pc}
;;;332    
                          ENDP

                  |L6.44|
                          DCD      m_flag_service_changed_pending

                          AREA ||i.gcm_init||, CODE, READONLY, ALIGN=2

                  gcm_init PROC
;;;351    
;;;352    ret_code_t gcm_init()
000000  b510              PUSH     {r4,lr}
;;;353    {
;;;354        NRF_PM_DEBUG_CHECK(!m_module_initialized);
;;;355    
;;;356        internal_state_reset();
000002  f7fffffe          BL       internal_state_reset
;;;357    
;;;358        m_flag_local_db_update_pending = ble_conn_state_user_flag_acquire();
000006  f7fffffe          BL       ble_conn_state_user_flag_acquire
00000a  4912              LDR      r1,|L7.84|
00000c  7008              STRB     r0,[r1,#0]
;;;359        m_flag_local_db_apply_pending  = ble_conn_state_user_flag_acquire();
00000e  f7fffffe          BL       ble_conn_state_user_flag_acquire
000012  4911              LDR      r1,|L7.88|
000014  7008              STRB     r0,[r1,#0]
;;;360        m_flag_service_changed_pending = ble_conn_state_user_flag_acquire();
000016  f7fffffe          BL       ble_conn_state_user_flag_acquire
00001a  4910              LDR      r1,|L7.92|
00001c  7008              STRB     r0,[r1,#0]
;;;361        m_flag_service_changed_sent    = ble_conn_state_user_flag_acquire();
00001e  f7fffffe          BL       ble_conn_state_user_flag_acquire
000022  490f              LDR      r1,|L7.96|
000024  7008              STRB     r0,[r1,#0]
;;;362    
;;;363        if  ((m_flag_local_db_update_pending  == BLE_CONN_STATE_USER_FLAG_INVALID)
000026  480b              LDR      r0,|L7.84|
000028  7800              LDRB     r0,[r0,#0]  ; m_flag_local_db_update_pending
00002a  2818              CMP      r0,#0x18
00002c  d00b              BEQ      |L7.70|
;;;364          || (m_flag_local_db_apply_pending   == BLE_CONN_STATE_USER_FLAG_INVALID)
00002e  480a              LDR      r0,|L7.88|
000030  7800              LDRB     r0,[r0,#0]  ; m_flag_local_db_apply_pending
000032  2818              CMP      r0,#0x18
000034  d007              BEQ      |L7.70|
;;;365          || (m_flag_service_changed_pending  == BLE_CONN_STATE_USER_FLAG_INVALID)
000036  4809              LDR      r0,|L7.92|
000038  7800              LDRB     r0,[r0,#0]  ; m_flag_service_changed_pending
00003a  2818              CMP      r0,#0x18
00003c  d003              BEQ      |L7.70|
;;;366          || (m_flag_service_changed_sent     == BLE_CONN_STATE_USER_FLAG_INVALID))
00003e  4608              MOV      r0,r1
000040  7800              LDRB     r0,[r0,#0]  ; m_flag_service_changed_sent
000042  2818              CMP      r0,#0x18
000044  d101              BNE      |L7.74|
                  |L7.70|
;;;367        {
;;;368            return NRF_ERROR_INTERNAL;
000046  2003              MOVS     r0,#3
                  |L7.72|
;;;369        }
;;;370    
;;;371        m_module_initialized = true;
;;;372    
;;;373        return NRF_SUCCESS;
;;;374    }
000048  bd10              POP      {r4,pc}
                  |L7.74|
00004a  2001              MOVS     r0,#1                 ;371
00004c  4905              LDR      r1,|L7.100|
00004e  7008              STRB     r0,[r1,#0]            ;371
000050  2000              MOVS     r0,#0                 ;373
000052  e7f9              B        |L7.72|
;;;375    
                          ENDP

                  |L7.84|
                          DCD      m_flag_local_db_update_pending
                  |L7.88|
                          DCD      m_flag_local_db_apply_pending
                  |L7.92|
                          DCD      m_flag_service_changed_pending
                  |L7.96|
                          DCD      m_flag_service_changed_sent
                  |L7.100|
                          DCD      m_module_initialized

                          AREA ||i.gcm_local_database_has_changed||, CODE, READONLY, ALIGN=2

                  gcm_local_database_has_changed PROC
;;;517    
;;;518    void gcm_local_database_has_changed(void)
000000  b510              PUSH     {r4,lr}
;;;519    {
000002  b086              SUB      sp,sp,#0x18
;;;520        gscm_local_database_has_changed();
000004  f7fffffe          BL       gscm_local_database_has_changed
;;;521    
;;;522        sdk_mapped_flags_key_list_t conn_handles = ble_conn_state_conn_handles();
000008  a801              ADD      r0,sp,#4
00000a  f7fffffe          BL       ble_conn_state_conn_handles
;;;523    
;;;524        for (uint16_t i = 0; i < conn_handles.len; i++)
00000e  2400              MOVS     r4,#0
000010  e012              B        |L8.56|
                  |L8.18|
;;;525        {
;;;526            if (im_peer_id_get_by_conn_handle(conn_handles.flag_keys[i]) == PM_PEER_ID_INVALID)
000012  a902              ADD      r1,sp,#8
000014  f8310014          LDRH     r0,[r1,r4,LSL #1]
000018  f7fffffe          BL       im_peer_id_get_by_conn_handle
00001c  f64f71ff          MOV      r1,#0xffff
000020  4288              CMP      r0,r1
000022  d107              BNE      |L8.52|
;;;527            {
;;;528                ble_conn_state_user_flag_set(conn_handles.flag_keys[i], m_flag_service_changed_pending, true);
000024  a902              ADD      r1,sp,#8
000026  f8310014          LDRH     r0,[r1,r4,LSL #1]
00002a  2201              MOVS     r2,#1
00002c  4906              LDR      r1,|L8.72|
00002e  7809              LDRB     r1,[r1,#0]  ; m_flag_service_changed_pending
000030  f7fffffe          BL       ble_conn_state_user_flag_set
                  |L8.52|
000034  1c60              ADDS     r0,r4,#1              ;524
000036  b284              UXTH     r4,r0                 ;524
                  |L8.56|
000038  9801              LDR      r0,[sp,#4]            ;524
00003a  42a0              CMP      r0,r4                 ;524
00003c  d8e9              BHI      |L8.18|
;;;529            }
;;;530        }
;;;531    
;;;532        service_changed_pending_flags_check();
00003e  f7fffffe          BL       service_changed_pending_flags_check
;;;533    }
000042  b006              ADD      sp,sp,#0x18
000044  bd10              POP      {r4,pc}
;;;534    #endif //PEER_MANAGER_ENABLED
                          ENDP

000046  0000              DCW      0x0000
                  |L8.72|
                          DCD      m_flag_service_changed_pending

                          AREA ||i.gcm_local_db_cache_set||, CODE, READONLY, ALIGN=1

                  gcm_local_db_cache_set PROC
;;;509    
;;;510    ret_code_t gcm_local_db_cache_set(pm_peer_id_t peer_id, pm_peer_data_local_gatt_db_t * p_local_db)
000000  b570              PUSH     {r4-r6,lr}
;;;511    {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;512        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;513    
;;;514        return gscm_local_db_cache_set(peer_id, p_local_db);
000006  4629              MOV      r1,r5
000008  4620              MOV      r0,r4
00000a  f7fffffe          BL       gscm_local_db_cache_set
;;;515    }
00000e  bd70              POP      {r4-r6,pc}
;;;516    
                          ENDP


                          AREA ||i.gcm_local_db_cache_update||, CODE, READONLY, ALIGN=2

                  gcm_local_db_cache_update PROC
;;;490    
;;;491    ret_code_t gcm_local_db_cache_update(uint16_t conn_handle)
000000  b570              PUSH     {r4-r6,lr}
;;;492    {
000002  4605              MOV      r5,r0
;;;493        NRF_PM_DEBUG_CHECK(m_module_initialized);
;;;494    
;;;495        ret_code_t err_code = gscm_local_db_cache_update(conn_handle);
000004  4628              MOV      r0,r5
000006  f7fffffe          BL       gscm_local_db_cache_update
00000a  4604              MOV      r4,r0
;;;496        bool set_procedure_as_pending = false;
00000c  2600              MOVS     r6,#0
;;;497    
;;;498        if (err_code == NRF_ERROR_BUSY)
00000e  2c11              CMP      r4,#0x11
000010  d101              BNE      |L10.22|
;;;499        {
;;;500            set_procedure_as_pending = true;
000012  2601              MOVS     r6,#1
;;;501            err_code = NRF_SUCCESS;
000014  2400              MOVS     r4,#0
                  |L10.22|
;;;502        }
;;;503    
;;;504        ble_conn_state_user_flag_set(conn_handle, m_flag_local_db_update_pending, set_procedure_as_pending);
000016  4632              MOV      r2,r6
000018  4803              LDR      r0,|L10.40|
00001a  7801              LDRB     r1,[r0,#0]  ; m_flag_local_db_update_pending
00001c  4628              MOV      r0,r5
00001e  f7fffffe          BL       ble_conn_state_user_flag_set
;;;505    
;;;506        return err_code;
000022  4620              MOV      r0,r4
;;;507    }
000024  bd70              POP      {r4-r6,pc}
;;;508    
                          ENDP

000026  0000              DCW      0x0000
                  |L10.40|
                          DCD      m_flag_local_db_update_pending

                          AREA ||i.gcm_smd_evt_handler||, CODE, READONLY, ALIGN=1

                  gcm_smd_evt_handler PROC
;;;338     */
;;;339    void gcm_smd_evt_handler(smd_evt_t const * p_event)
000000  b510              PUSH     {r4,lr}
;;;340    {
000002  4604              MOV      r4,r0
;;;341        switch (p_event->evt_id)
000004  7820              LDRB     r0,[r4,#0]
000006  2807              CMP      r0,#7
000008  d103              BNE      |L11.18|
;;;342        {
;;;343            case SMD_EVT_BONDING_INFO_STORED:
;;;344                local_db_update_in_evt(p_event->conn_handle);
00000a  8860              LDRH     r0,[r4,#2]
00000c  f7fffffe          BL       local_db_update_in_evt
;;;345                break;
000010  e000              B        |L11.20|
                  |L11.18|
;;;346            default:
;;;347                break;
000012  bf00              NOP      
                  |L11.20|
000014  bf00              NOP                            ;345
;;;348        }
;;;349    }
000016  bd10              POP      {r4,pc}
;;;350    
                          ENDP


                          AREA ||i.internal_state_reset||, CODE, READONLY, ALIGN=2

                  internal_state_reset PROC
;;;52      */
;;;53     static void internal_state_reset()
000000  2000              MOVS     r0,#0
;;;54     {
;;;55         m_module_initialized = false;
000002  4901              LDR      r1,|L12.8|
000004  7008              STRB     r0,[r1,#0]
;;;56     }
000006  4770              BX       lr
;;;57     
                          ENDP

                  |L12.8|
                          DCD      m_module_initialized

                          AREA ||i.local_db_apply_in_evt||, CODE, READONLY, ALIGN=2

                  local_db_apply_in_evt PROC
;;;91      */
;;;92     static void local_db_apply_in_evt(uint16_t conn_handle)
000000  b5fe              PUSH     {r1-r7,lr}
;;;93     {
000002  4604              MOV      r4,r0
;;;94         bool set_procedure_as_pending = false;
000004  2600              MOVS     r6,#0
;;;95         ret_code_t err_code;
;;;96         gcm_evt_t event;
;;;97     
;;;98         if (conn_handle == BLE_CONN_HANDLE_INVALID)
000006  f64f70ff          MOV      r0,#0xffff
00000a  4284              CMP      r4,r0
00000c  d100              BNE      |L13.16|
                  |L13.14|
;;;99         {
;;;100            return;
;;;101        }
;;;102    
;;;103        err_code = gscm_local_db_cache_apply(conn_handle);
;;;104    
;;;105        switch (err_code)
;;;106        {
;;;107            case NRF_SUCCESS:
;;;108                event.evt_id                                    = GCM_EVT_LOCAL_DB_CACHE_APPLIED;
;;;109                event.peer_id                                   = im_peer_id_get_by_conn_handle(conn_handle);
;;;110                event.params.local_db_cache_applied.conn_handle = conn_handle;
;;;111    
;;;112                evt_send(&event);
;;;113                break;
;;;114    
;;;115            case NRF_ERROR_BUSY:
;;;116                set_procedure_as_pending = true;
;;;117                break;
;;;118    
;;;119            case NRF_ERROR_INVALID_DATA:
;;;120                event.evt_id                                        = GCM_EVT_ERROR_LOCAL_DB_CACHE_APPLY;
;;;121                event.peer_id                                       = im_peer_id_get_by_conn_handle(conn_handle);
;;;122                event.params.error_local_db_cache_apply.conn_handle = conn_handle;
;;;123    
;;;124                evt_send(&event);
;;;125                break;
;;;126    
;;;127            case BLE_ERROR_INVALID_CONN_HANDLE:
;;;128                /* Do nothing */
;;;129                break;
;;;130    
;;;131            default:
;;;132                event.evt_id                              = GCM_EVT_ERROR_UNEXPECTED;
;;;133                event.peer_id                             = im_peer_id_get_by_conn_handle(conn_handle);
;;;134                event.params.error_unexpected.conn_handle = conn_handle;
;;;135                event.params.error_unexpected.error       = err_code;
;;;136    
;;;137                evt_send(&event);
;;;138                break;
;;;139        }
;;;140    
;;;141        ble_conn_state_user_flag_set(conn_handle, m_flag_local_db_apply_pending, set_procedure_as_pending);
;;;142    }
00000e  bdfe              POP      {r1-r7,pc}
                  |L13.16|
000010  4620              MOV      r0,r4                 ;103
000012  f7fffffe          BL       gscm_local_db_cache_apply
000016  4605              MOV      r5,r0                 ;103
000018  b145              CBZ      r5,|L13.44|
00001a  2d0b              CMP      r5,#0xb               ;105
00001c  d016              BEQ      |L13.76|
00001e  2d11              CMP      r5,#0x11              ;105
000020  d012              BEQ      |L13.72|
000022  f5a55040          SUB      r0,r5,#0x3000         ;105
000026  3802              SUBS     r0,#2                 ;105
000028  b9f8              CBNZ     r0,|L13.106|
00002a  e01d              B        |L13.104|
                  |L13.44|
00002c  2002              MOVS     r0,#2                 ;108
00002e  f88d0000          STRB     r0,[sp,#0]            ;108
000032  4620              MOV      r0,r4                 ;109
000034  f7fffffe          BL       im_peer_id_get_by_conn_handle
000038  f8ad0002          STRH     r0,[sp,#2]            ;109
00003c  f8ad4004          STRH     r4,[sp,#4]            ;110
000040  4668              MOV      r0,sp                 ;112
000042  f7fffffe          BL       evt_send
000046  e01f              B        |L13.136|
                  |L13.72|
000048  2601              MOVS     r6,#1                 ;116
00004a  e01d              B        |L13.136|
                  |L13.76|
00004c  2003              MOVS     r0,#3                 ;120
00004e  f88d0000          STRB     r0,[sp,#0]            ;120
000052  4620              MOV      r0,r4                 ;121
000054  f7fffffe          BL       im_peer_id_get_by_conn_handle
000058  f8ad0002          STRH     r0,[sp,#2]            ;121
00005c  f8ad4004          STRH     r4,[sp,#4]            ;122
000060  4668              MOV      r0,sp                 ;124
000062  f7fffffe          BL       evt_send
000066  e00f              B        |L13.136|
                  |L13.104|
000068  e00e              B        |L13.136|
                  |L13.106|
00006a  2009              MOVS     r0,#9                 ;132
00006c  f88d0000          STRB     r0,[sp,#0]            ;132
000070  4620              MOV      r0,r4                 ;133
000072  f7fffffe          BL       im_peer_id_get_by_conn_handle
000076  f8ad0002          STRH     r0,[sp,#2]            ;133
00007a  f8ad4004          STRH     r4,[sp,#4]            ;134
00007e  9502              STR      r5,[sp,#8]            ;135
000080  4668              MOV      r0,sp                 ;137
000082  f7fffffe          BL       evt_send
000086  bf00              NOP                            ;138
                  |L13.136|
000088  bf00              NOP                            ;113
00008a  4632              MOV      r2,r6                 ;141
00008c  4803              LDR      r0,|L13.156|
00008e  7801              LDRB     r1,[r0,#0]            ;141  ; m_flag_local_db_apply_pending
000090  4620              MOV      r0,r4                 ;141
000092  f7fffffe          BL       ble_conn_state_user_flag_set
000096  bf00              NOP      
000098  e7b9              B        |L13.14|
;;;143    
                          ENDP

00009a  0000              DCW      0x0000
                  |L13.156|
                          DCD      m_flag_local_db_apply_pending

                          AREA ||i.local_db_update_in_evt||, CODE, READONLY, ALIGN=2

                  local_db_update_in_evt PROC
;;;152     */
;;;153    static void local_db_update_in_evt(uint16_t conn_handle)
000000  b5fe              PUSH     {r1-r7,lr}
;;;154    {
000002  4604              MOV      r4,r0
;;;155        gcm_evt_t event;
;;;156        bool set_procedure_as_pending = false;
000004  2600              MOVS     r6,#0
;;;157        ret_code_t err_code = gscm_local_db_cache_update(conn_handle);
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       gscm_local_db_cache_update
00000c  4605              MOV      r5,r0
;;;158    
;;;159        switch (err_code)
00000e  2d0c              CMP      r5,#0xc
000010  d01c              BEQ      |L14.76|
000012  dc03              BGT      |L14.28|
000014  b14d              CBZ      r5,|L14.42|
000016  2d04              CMP      r5,#4
000018  d134              BNE      |L14.132|
00001a  e025              B        |L14.104|
                  |L14.28|
00001c  2d11              CMP      r5,#0x11
00001e  d013              BEQ      |L14.72|
000020  f5a55040          SUB      r0,r5,#0x3000
000024  3802              SUBS     r0,#2
000026  bb68              CBNZ     r0,|L14.132|
000028  e00d              B        |L14.70|
                  |L14.42|
;;;160        {
;;;161            case NRF_SUCCESS:
;;;162                event.evt_id                                    = GCM_EVT_LOCAL_DB_CACHE_UPDATED;
00002a  2001              MOVS     r0,#1
00002c  f88d0000          STRB     r0,[sp,#0]
;;;163                event.params.local_db_cache_applied.conn_handle = conn_handle;
000030  f8ad4004          STRH     r4,[sp,#4]
;;;164                event.peer_id                                   = im_peer_id_get_by_conn_handle(conn_handle);
000034  4620              MOV      r0,r4
000036  f7fffffe          BL       im_peer_id_get_by_conn_handle
00003a  f8ad0002          STRH     r0,[sp,#2]
;;;165    
;;;166                evt_send(&event);
00003e  4668              MOV      r0,sp
000040  f7fffffe          BL       evt_send
;;;167                break;
000044  e02d              B        |L14.162|
                  |L14.70|
;;;168    
;;;169            case BLE_ERROR_INVALID_CONN_HANDLE:
;;;170                /* Do nothing */
;;;171                break;
000046  e02c              B        |L14.162|
                  |L14.72|
;;;172    
;;;173            case NRF_ERROR_BUSY:
;;;174                set_procedure_as_pending = true;
000048  2601              MOVS     r6,#1
;;;175                break;
00004a  e02a              B        |L14.162|
                  |L14.76|
;;;176    
;;;177            case NRF_ERROR_DATA_SIZE:
;;;178                event.evt_id = GCM_EVT_ERROR_DATA_SIZE;
00004c  2007              MOVS     r0,#7
00004e  f88d0000          STRB     r0,[sp,#0]
;;;179                event.params.error_data_size.conn_handle = conn_handle;
000052  f8ad4004          STRH     r4,[sp,#4]
;;;180                event.peer_id = im_peer_id_get_by_conn_handle(conn_handle);
000056  4620              MOV      r0,r4
000058  f7fffffe          BL       im_peer_id_get_by_conn_handle
00005c  f8ad0002          STRH     r0,[sp,#2]
;;;181    
;;;182                evt_send(&event);
000060  4668              MOV      r0,sp
000062  f7fffffe          BL       evt_send
;;;183                break;
000066  e01c              B        |L14.162|
                  |L14.104|
;;;184    
;;;185            case NRF_ERROR_NO_MEM:
;;;186                event.evt_id = GCM_EVT_ERROR_STORAGE_FULL;
000068  2008              MOVS     r0,#8
00006a  f88d0000          STRB     r0,[sp,#0]
;;;187                event.params.error_no_mem.conn_handle = conn_handle;
00006e  f8ad4004          STRH     r4,[sp,#4]
;;;188                event.peer_id = im_peer_id_get_by_conn_handle(conn_handle);
000072  4620              MOV      r0,r4
000074  f7fffffe          BL       im_peer_id_get_by_conn_handle
000078  f8ad0002          STRH     r0,[sp,#2]
;;;189    
;;;190                evt_send(&event);
00007c  4668              MOV      r0,sp
00007e  f7fffffe          BL       evt_send
;;;191                break;
000082  e00e              B        |L14.162|
                  |L14.132|
;;;192    
;;;193            default:
;;;194                event.evt_id                              = GCM_EVT_ERROR_UNEXPECTED;
000084  2009              MOVS     r0,#9
000086  f88d0000          STRB     r0,[sp,#0]
;;;195                event.peer_id                             = im_peer_id_get_by_conn_handle(conn_handle);
00008a  4620              MOV      r0,r4
00008c  f7fffffe          BL       im_peer_id_get_by_conn_handle
000090  f8ad0002          STRH     r0,[sp,#2]
;;;196                event.params.error_unexpected.conn_handle = conn_handle;
000094  f8ad4004          STRH     r4,[sp,#4]
;;;197                event.params.error_unexpected.error       = err_code;
000098  9502              STR      r5,[sp,#8]
;;;198    
;;;199                evt_send(&event);
00009a  4668              MOV      r0,sp
00009c  f7fffffe          BL       evt_send
;;;200                break;
0000a0  bf00              NOP      
                  |L14.162|
0000a2  bf00              NOP                            ;167
;;;201        }
;;;202    
;;;203        ble_conn_state_user_flag_set(conn_handle, m_flag_local_db_update_pending, set_procedure_as_pending);
0000a4  4632              MOV      r2,r6
0000a6  4803              LDR      r0,|L14.180|
0000a8  7801              LDRB     r1,[r0,#0]  ; m_flag_local_db_update_pending
0000aa  4620              MOV      r0,r4
0000ac  f7fffffe          BL       ble_conn_state_user_flag_set
;;;204    }
0000b0  bdfe              POP      {r1-r7,pc}
;;;205    
                          ENDP

0000b2  0000              DCW      0x0000
                  |L14.180|
                          DCD      m_flag_local_db_update_pending

                          AREA ||i.sdk_mapped_flags_any_set||, CODE, READONLY, ALIGN=1

                  sdk_mapped_flags_any_set PROC
;;;148     */
;;;149    static __INLINE bool sdk_mapped_flags_any_set(sdk_mapped_flags_t flags)
000000  4601              MOV      r1,r0
;;;150    {
;;;151        return (flags != 0);
000002  b109              CBZ      r1,|L15.8|
000004  2001              MOVS     r0,#1
                  |L15.6|
;;;152    }
000006  4770              BX       lr
                  |L15.8|
000008  2000              MOVS     r0,#0                 ;151
00000a  e7fc              B        |L15.6|
;;;153    
                          ENDP


                          AREA ||i.service_changed_pending_flags_check||, CODE, READONLY, ALIGN=2

                  service_changed_pending_flags_check PROC
;;;427     */
;;;428    static void service_changed_pending_flags_check(void)
000000  b530              PUSH     {r4,r5,lr}
;;;429    {
000002  b08b              SUB      sp,sp,#0x2c
;;;430        sdk_mapped_flags_t service_changed_pending_flags;
;;;431    
;;;432        service_changed_pending_flags = ble_conn_state_user_flag_collection(m_flag_service_changed_pending);
000004  4817              LDR      r0,|L16.100|
000006  7800              LDRB     r0,[r0,#0]  ; m_flag_service_changed_pending
000008  f7fffffe          BL       ble_conn_state_user_flag_collection
00000c  4605              MOV      r5,r0
;;;433        if (sdk_mapped_flags_any_set(service_changed_pending_flags))
00000e  4628              MOV      r0,r5
000010  f7fffffe          BL       sdk_mapped_flags_any_set
000014  b318              CBZ      r0,|L16.94|
;;;434        {
;;;435            sdk_mapped_flags_key_list_t conn_handle_list;
;;;436            conn_handle_list = ble_conn_state_conn_handles();
000016  a801              ADD      r0,sp,#4
000018  f7fffffe          BL       ble_conn_state_conn_handles
00001c  2214              MOVS     r2,#0x14
00001e  a901              ADD      r1,sp,#4
000020  a806              ADD      r0,sp,#0x18
000022  f7fffffe          BL       __aeabi_memcpy4
;;;437    
;;;438            for (uint32_t i = 0; i < conn_handle_list.len; i++)
000026  2400              MOVS     r4,#0
000028  e015              B        |L16.86|
                  |L16.42|
;;;439            {
;;;440                if (    ble_conn_state_user_flag_get(conn_handle_list.flag_keys[i],
00002a  a907              ADD      r1,sp,#0x1c
00002c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000030  490c              LDR      r1,|L16.100|
000032  7809              LDRB     r1,[r1,#0]  ; m_flag_service_changed_pending
000034  f7fffffe          BL       ble_conn_state_user_flag_get
000038  b160              CBZ      r0,|L16.84|
;;;441                                                     m_flag_service_changed_pending)
;;;442                    && !ble_conn_state_user_flag_get(conn_handle_list.flag_keys[i],
00003a  a907              ADD      r1,sp,#0x1c
00003c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000040  4909              LDR      r1,|L16.104|
000042  7809              LDRB     r1,[r1,#0]  ; m_flag_service_changed_sent
000044  f7fffffe          BL       ble_conn_state_user_flag_get
000048  b920              CBNZ     r0,|L16.84|
;;;443                                                     m_flag_service_changed_sent))
;;;444                {
;;;445                    service_changed_send_in_evt(conn_handle_list.flag_keys[i]);
00004a  a907              ADD      r1,sp,#0x1c
00004c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000050  f7fffffe          BL       service_changed_send_in_evt
                  |L16.84|
000054  1c64              ADDS     r4,r4,#1              ;438
                  |L16.86|
000056  9806              LDR      r0,[sp,#0x18]         ;438
000058  42a0              CMP      r0,r4                 ;438
00005a  d8e6              BHI      |L16.42|
;;;446                }
;;;447            }
;;;448        }
00005c  bf00              NOP      
                  |L16.94|
;;;449    }
00005e  b00b              ADD      sp,sp,#0x2c
000060  bd30              POP      {r4,r5,pc}
;;;450    
                          ENDP

000062  0000              DCW      0x0000
                  |L16.100|
                          DCD      m_flag_service_changed_pending
                  |L16.104|
                          DCD      m_flag_service_changed_sent

                          AREA ||i.service_changed_send_in_evt||, CODE, READONLY, ALIGN=2

                  service_changed_send_in_evt PROC
;;;214     */
;;;215    static void service_changed_send_in_evt(uint16_t conn_handle)
000000  e92d43fe          PUSH     {r1-r9,lr}
;;;216    {
000004  4604              MOV      r4,r0
;;;217        gcm_evt_t event;
;;;218        bool sc_pending_state = true;
000006  2601              MOVS     r6,#1
;;;219        bool sc_sent_state = false;
000008  2700              MOVS     r7,#0
;;;220        ret_code_t err_code = gscm_service_changed_ind_send(conn_handle);
00000a  4620              MOV      r0,r4
00000c  f7fffffe          BL       gscm_service_changed_ind_send
000010  4605              MOV      r5,r0
;;;221    
;;;222        switch (err_code)
000012  4628              MOV      r0,r5
000014  2d11              CMP      r5,#0x11
000016  d01d              BEQ      |L17.84|
000018  dc05              BGT      |L17.38|
00001a  b160              CBZ      r0,|L17.54|
00001c  2806              CMP      r0,#6
00001e  d01b              BEQ      |L17.88|
000020  2808              CMP      r0,#8
000022  d126              BNE      |L17.114|
000024  e017              B        |L17.86|
                  |L17.38|
000026  f5a05040          SUB      r0,r0,#0x3000
00002a  3802              SUBS     r0,#2
00002c  b300              CBZ      r0,|L17.112|
00002e  f2a030ff          SUB      r0,r0,#0x3ff
000032  b9f0              CBNZ     r0,|L17.114|
000034  e018              B        |L17.104|
                  |L17.54|
;;;223        {
;;;224            case NRF_SUCCESS:
;;;225                sc_sent_state = true;
000036  2701              MOVS     r7,#1
;;;226    
;;;227                event.evt_id = GCM_EVT_SERVICE_CHANGED_IND_SENT;
000038  2005              MOVS     r0,#5
00003a  f88d0000          STRB     r0,[sp,#0]
;;;228                event.peer_id = im_peer_id_get_by_conn_handle(conn_handle);
00003e  4620              MOV      r0,r4
000040  f7fffffe          BL       im_peer_id_get_by_conn_handle
000044  f8ad0002          STRH     r0,[sp,#2]
;;;229                event.params.service_changed_ind_sent.conn_handle = conn_handle;
000048  f8ad4004          STRH     r4,[sp,#4]
;;;230    
;;;231                evt_send(&event);
00004c  4668              MOV      r0,sp
00004e  f7fffffe          BL       evt_send
;;;232                break;
000052  e01d              B        |L17.144|
                  |L17.84|
;;;233    
;;;234            case NRF_ERROR_BUSY:
;;;235                // Do nothing.
;;;236                break;
000054  e01c              B        |L17.144|
                  |L17.86|
;;;237    
;;;238            case NRF_ERROR_INVALID_STATE:
;;;239                // CCCDs not enabled. Drop indication.
;;;240                // Fallthrough.
;;;241    
;;;242            case NRF_ERROR_NOT_SUPPORTED:
000056  bf00              NOP      
                  |L17.88|
;;;243                // Service changed not supported. Drop indication.
;;;244                sc_pending_state = false;
000058  2600              MOVS     r6,#0
;;;245                gscm_db_change_notification_done(im_peer_id_get_by_conn_handle(conn_handle));
00005a  4620              MOV      r0,r4
00005c  f7fffffe          BL       im_peer_id_get_by_conn_handle
000060  4680              MOV      r8,r0
000062  f7fffffe          BL       gscm_db_change_notification_done
;;;246                break;
000066  e013              B        |L17.144|
                  |L17.104|
;;;247    
;;;248            case BLE_ERROR_GATTS_SYS_ATTR_MISSING:
;;;249                local_db_apply_in_evt(conn_handle);
000068  4620              MOV      r0,r4
00006a  f7fffffe          BL       local_db_apply_in_evt
;;;250                break;
00006e  e00f              B        |L17.144|
                  |L17.112|
;;;251    
;;;252            case BLE_ERROR_INVALID_CONN_HANDLE:
;;;253                // Do nothing.
;;;254                break;
000070  e00e              B        |L17.144|
                  |L17.114|
;;;255    
;;;256            default:
;;;257                event.evt_id = GCM_EVT_ERROR_UNEXPECTED;
000072  2009              MOVS     r0,#9
000074  f88d0000          STRB     r0,[sp,#0]
;;;258                event.params.error_unexpected.conn_handle = conn_handle;
000078  f8ad4004          STRH     r4,[sp,#4]
;;;259                event.params.error_unexpected.error = err_code;
00007c  9502              STR      r5,[sp,#8]
;;;260                event.peer_id = im_peer_id_get_by_conn_handle(conn_handle);
00007e  4620              MOV      r0,r4
000080  f7fffffe          BL       im_peer_id_get_by_conn_handle
000084  f8ad0002          STRH     r0,[sp,#2]
;;;261    
;;;262                evt_send(&event);
000088  4668              MOV      r0,sp
00008a  f7fffffe          BL       evt_send
;;;263                break;
00008e  bf00              NOP      
                  |L17.144|
000090  bf00              NOP                            ;232
;;;264        }
;;;265    
;;;266        ble_conn_state_user_flag_set(conn_handle, m_flag_service_changed_pending, sc_pending_state);
000092  4632              MOV      r2,r6
000094  4806              LDR      r0,|L17.176|
000096  7801              LDRB     r1,[r0,#0]  ; m_flag_service_changed_pending
000098  4620              MOV      r0,r4
00009a  f7fffffe          BL       ble_conn_state_user_flag_set
;;;267        ble_conn_state_user_flag_set(conn_handle, m_flag_service_changed_sent, sc_sent_state);
00009e  463a              MOV      r2,r7
0000a0  4804              LDR      r0,|L17.180|
0000a2  7801              LDRB     r1,[r0,#0]  ; m_flag_service_changed_sent
0000a4  4620              MOV      r0,r4
0000a6  f7fffffe          BL       ble_conn_state_user_flag_set
;;;268    }
0000aa  e8bd83fe          POP      {r1-r9,pc}
;;;269    
                          ENDP

0000ae  0000              DCW      0x0000
                  |L17.176|
                          DCD      m_flag_service_changed_pending
                  |L17.180|
                          DCD      m_flag_service_changed_sent

                          AREA ||i.update_pending_flags_check||, CODE, READONLY, ALIGN=2

                  update_pending_flags_check PROC
;;;404     */
;;;405    static void update_pending_flags_check(void)
000000  b530              PUSH     {r4,r5,lr}
;;;406    {
000002  b08b              SUB      sp,sp,#0x2c
;;;407        sdk_mapped_flags_t update_pending_flags;
;;;408    
;;;409        update_pending_flags = ble_conn_state_user_flag_collection(m_flag_local_db_update_pending);
000004  4813              LDR      r0,|L18.84|
000006  7800              LDRB     r0,[r0,#0]  ; m_flag_local_db_update_pending
000008  f7fffffe          BL       ble_conn_state_user_flag_collection
00000c  4605              MOV      r5,r0
;;;410        if (sdk_mapped_flags_any_set(update_pending_flags))
00000e  4628              MOV      r0,r5
000010  f7fffffe          BL       sdk_mapped_flags_any_set
000014  b1d8              CBZ      r0,|L18.78|
;;;411        {
;;;412            sdk_mapped_flags_key_list_t conn_handle_list;
;;;413            conn_handle_list = ble_conn_state_conn_handles();
000016  a801              ADD      r0,sp,#4
000018  f7fffffe          BL       ble_conn_state_conn_handles
00001c  2214              MOVS     r2,#0x14
00001e  a901              ADD      r1,sp,#4
000020  a806              ADD      r0,sp,#0x18
000022  f7fffffe          BL       __aeabi_memcpy4
;;;414    
;;;415            for (uint32_t i = 0; i < conn_handle_list.len; i++)
000026  2400              MOVS     r4,#0
000028  e00d              B        |L18.70|
                  |L18.42|
;;;416            {
;;;417                if (ble_conn_state_user_flag_get(conn_handle_list.flag_keys[i], m_flag_local_db_update_pending))
00002a  a907              ADD      r1,sp,#0x1c
00002c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000030  4908              LDR      r1,|L18.84|
000032  7809              LDRB     r1,[r1,#0]  ; m_flag_local_db_update_pending
000034  f7fffffe          BL       ble_conn_state_user_flag_get
000038  b120              CBZ      r0,|L18.68|
;;;418                {
;;;419                    local_db_update_in_evt(conn_handle_list.flag_keys[i]);
00003a  a907              ADD      r1,sp,#0x1c
00003c  f8310014          LDRH     r0,[r1,r4,LSL #1]
000040  f7fffffe          BL       local_db_update_in_evt
                  |L18.68|
000044  1c64              ADDS     r4,r4,#1              ;415
                  |L18.70|
000046  9806              LDR      r0,[sp,#0x18]         ;415
000048  42a0              CMP      r0,r4                 ;415
00004a  d8ee              BHI      |L18.42|
;;;420                }
;;;421            }
;;;422        }
00004c  bf00              NOP      
                  |L18.78|
;;;423    }
00004e  b00b              ADD      sp,sp,#0x2c
000050  bd30              POP      {r4,r5,pc}
;;;424    
                          ENDP

000052  0000              DCW      0x0000
                  |L18.84|
                          DCD      m_flag_local_db_update_pending

                          AREA ||.data||, DATA, ALIGN=2

                  m_evt_handlers
                          DCD      pm_gcm_evt_handler
                  m_module_initialized
000004  00                DCB      0x00
                  m_flag_local_db_update_pending
000005  00                DCB      0x00
                  m_flag_local_db_apply_pending
000006  00                DCB      0x00
                  m_flag_service_changed_pending
000007  00                DCB      0x00
                  m_flag_service_changed_sent
000008  00                DCB      0x00

;*** Start embedded assembler ***

#line 1 "..\\..\\..\\..\\..\\..\\components\\ble\\peer_manager\\gatt_cache_manager.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___20_gatt_cache_manager_c_40c97f5c____REV16|
#line 388 "C:\\Keil_v5\\ARM\\PACK\\ARM\\CMSIS\\4.5.0\\CMSIS\\Include\\cmsis_armcc.h"
|__asm___20_gatt_cache_manager_c_40c97f5c____REV16| PROC
#line 389

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___20_gatt_cache_manager_c_40c97f5c____REVSH|
#line 402
|__asm___20_gatt_cache_manager_c_40c97f5c____REVSH| PROC
#line 403

 revsh r0, r0
 bx lr
	ENDP
	AREA ||.rrx_text||, CODE
	THUMB
	EXPORT |__asm___20_gatt_cache_manager_c_40c97f5c____RRX|
#line 587
|__asm___20_gatt_cache_manager_c_40c97f5c____RRX| PROC
#line 588

 rrx r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
